<html>
<head>
    <title>Configure Translator</title>
</head>
<body>
    <h1>Configure Translator</h1>

    <div>
        <button onclick="submit()">Submit</button>
    </div>
    <div>
        <input type="checkbox" id="id_af" name="af" value="1" />
        <label for="id_af">Afrikaans</label>
    </div>
    <div>
        <input type="checkbox" id="id_ar" name="ar" value="1" />
        <label for="id_ar">Arabic</label>
    </div>
    <div>
        <input type="checkbox" id="id_bn" name="bn" value="1" />
        <label for="id_bn">Bengali</label>
    </div>
    <div>
        <input type="checkbox" id="id_bs-Latn" name="bs-Latn" value="1" />
        <label for="id_bs-Latn">Bosnian</label>
    </div>
    <div>
        <input type="checkbox" id="id_bg" name="bg" value="1" />
        <label for="id_bg">Bulgarian</label>
    </div>
    <div>
        <input type="checkbox" id="id_ca" name="ca" value="1" />
        <label for="id_ca">Catalan</label>
    </div>
    <div>
        <input type="checkbox" id="id_zh-CHS" name="zh-CHS" value="1" />
        <label for="id_zh-CHS">Chinese (Simplified)</label>
    </div>
    <div>
        <input type="checkbox" id="id_zh-CHT" name="zh-CHT" value="1" />
        <label for="id_zh-CHT">Chinese (Traditional)</label>
    </div>
    <div>
        <input type="checkbox" id="id_hr" name="hr" value="1" />
        <label for="id_hr">Croatian</label>
    </div>
    <div>
        <input type="checkbox" id="id_cs" name="cs" value="1" />
        <label for="id_cs">Czech</label>
    </div>
    <div>
        <input type="checkbox" id="id_da" name="da" value="1" />
        <label for="id_da">Danish</label>
    </div>
    <div>
        <input type="checkbox" id="id_nl" name="nl" value="1" />
        <label for="id_nl">Dutch</label>
    </div>
    <div>
        <input type="checkbox" id="id_en" name="en" value="1" />
        <label for="id_en">English</label>
    </div>
    <div>
        <input type="checkbox" id="id_et" name="et" value="1" />
        <label for="id_et">Estonian</label>
    </div>
    <div>
        <input type="checkbox" id="id_fj" name="fj" value="1" />
        <label for="id_fj">Fijian</label>
    </div>
    <div>
        <input type="checkbox" id="id_fil" name="fil" value="1" />
        <label for="id_fil">Filipino</label>
    </div>
    <div>
        <input type="checkbox" id="id_fi" name="fi" value="1" />
        <label for="id_fi">Finnish</label>
    </div>
    <div>
        <input type="checkbox" id="id_fr" name="fr" value="1" />
        <label for="id_fr">French</label>
    </div>
    <div>
        <input type="checkbox" id="id_de" name="de" value="1" />
        <label for="id_de">German</label>
    </div>
    <div>
        <input type="checkbox" id="id_el" name="el" value="1" />
        <label for="id_el">Greek</label>
    </div>
    <div>
        <input type="checkbox" id="id_ht" name="ht" value="1" />
        <label for="id_ht">Haitian</label>
    </div>
    <div>
        <input type="checkbox" id="id_he" name="he" value="1" />
        <label for="id_he">Hebrew</label>
    </div>
    <div>
        <input type="checkbox" id="id_hi" name="hi" value="1" />
        <label for="id_hi">Hindi</label>
    </div>
    <div>
        <input type="checkbox" id="id_hu" name="hu" value="1" />
        <label for="id_hu">Hungarian</label>
    </div>
    <div>
        <input type="checkbox" id="id_id" name="id" value="1" />
        <label for="id_id">Indonesian</label>
    </div>
    <div>
        <input type="checkbox" id="id_it" name="it" value="1" />
        <label for="id_it">Italian</label>
    </div>
    <div>
        <input type="checkbox" id="id_ja" name="ja" value="1" />
        <label for="id_ja">Japanese</label>
    </div>
    <div>
        <input type="checkbox" id="id_sw" name="sw" value="1" />
        <label for="id_sw">Swedish</label>
    </div>
    <div>
        <input type="checkbox" id="id_ko" name="ko" value="1" />
        <label for="id_ko">Korean</label>
    </div>
    <div>
        <input type="checkbox" id="id_lv" name="lv" value="1" />
        <label for="id_lv">Latvian</label>
    </div>
    <div>
        <input type="checkbox" id="id_lt" name="lt" value="1" />
        <label for="id_lt">Lithuanian</label>
    </div>
    <div>
        <input type="checkbox" id="id_mg" name="mg" value="1" />
        <label for="id_mg">Malagasy</label>
    </div>
    <div>
        <input type="checkbox" id="id_ms" name="ms" value="1" />
        <label for="id_ms">Malay</label>
    </div>
    <div>
        <input type="checkbox" id="id_mt" name="mt" value="1" />
        <label for="id_mt">Maltese</label>
    </div>
    <div>
        <input type="checkbox" id="id_no" name="no" value="1" />
        <label for="id_no">Norwegian</label>
    </div>
    <div>
        <input type="checkbox" id="id_fa" name="fa" value="1" />
        <label for="id_fa">Persian</label>
    </div>
    <div>
        <input type="checkbox" id="id_pl" name="pl" value="1" />
        <label for="id_pl">Polish</label>
    </div>
    <div>
        <input type="checkbox" id="id_pt" name="pt" value="1" />
        <label for="id_pt">Portuguese</label>
    </div>
    <div>
        <input type="checkbox" id="id_ro" name="ro" value="1" />
        <label for="id_ro">Romanian</label>
    </div>
    <div>
        <input type="checkbox" id="id_ru" name="ru" value="1" />
        <label for="id_ru">Russian</label>
    </div>
    <div>
        <input type="checkbox" id="id_sm" name="sm" value="1" />
        <label for="id_sm">Samoan</label>
    </div>
    <div>
        <input type="checkbox" id="id_sr-Cyrl" name="sr-Cyrl" value="1" />
        <label for="id_sr-Cyrl">Serbian (Cyrillic)</label>
    </div>
    <div>
        <input type="checkbox" id="id_sr-Latn" name="sr-Latn" value="1" />
        <label for="id_sr-Latn">Serbian (Latin)</label>
    </div>
    <div>
        <input type="checkbox" id="id_sk" name="sk" value="1" />
        <label for="id_sk">Slovak</label>
    </div>
    <div>
        <input type="checkbox" id="id_sl" name="sl" value="1" />
        <label for="id_sl">Slovenian</label>
    </div>
    <div>
        <input type="checkbox" id="id_es" name="es" value="1" />
        <label for="id_es">Spanish</label>
    </div>
    <div>
        <input type="checkbox" id="id_sv" name="sv" value="1" />
        <label for="id_sv">Swedish</label>
    </div>
    <div>
        <input type="checkbox" id="id_ty" name="ty" value="1" />
        <label for="id_ty">Tahitian</label>
    </div>
    <div>
        <input type="checkbox" id="id_th" name="th" value="1" />
        <label for="id_th">Thai</label>
    </div>
    <div>
        <input type="checkbox" id="id_to" name="to" value="1" />
        <label for="id_to">Tonga</label>
    </div>
    <div>
        <input type="checkbox" id="id_tr" name="tr" value="1" />
        <label for="id_tr">Turkish</label>
    </div>
    <div>
        <input type="checkbox" id="id_uk" name="uk" value="1" />
        <label for="id_uk">Ukranian</label>
    </div>
    <div>
        <input type="checkbox" id="id_ur" name="ur" value="1" />
        <label for="id_ur">Urdu</label>
    </div>
    <div>
        <input type="checkbox" id="id_vi" name="vi" value="1" />
        <label for="id_vi">Vietnamese</label>
    </div>
    <div>
        <input type="checkbox" id="id_cy" name="cy" value="1" />
        <label for="id_cy">Welsh</label>
    </div>

    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.1.1.min.js"></script>
    <script src="https://statics.teams.microsoft.com/sdk/v1.0/js/MicrosoftTeams.min.js"></script>
    <script type="text/javascript">
          microsoftTeams.initialize();

          // Parse query parameters
          let queryParams = {};
          location.search.substr(1).split("&").forEach(function(item) {
              let s = item.split("="),
              k = s[0],
              v = s[1] && decodeURIComponent(s[1]);
              queryParams[k] = v;
          });

          // Initialize state of checkboxes
          $().ready(() => {
            let languages = queryParams["languages"] || "";
            languages.split(",").forEach((lang) => {
                let cb = $("#id_" + lang)[0];
                console.log(cb);
                if (cb) {
                    cb.checked = true;
                }
            });
          });

          function submit() {
            let checked = $("input[type='checkbox']").filter((i,e) => e.checked).get();
            let newSetting = checked.map(c => c.name).join(",");
            microsoftTeams.authentication.notifySuccess(newSetting);
          }
    </script>
</body>
</html>